function [] = plot_dose (MatriceParticules,Emin, tailleMatrice,tailleBoite)MatriceDose=zeros(tailleMatrice);%sub2ind numero de la case dans la matricexyE=[MatriceParticules(:,5) MatriceParticules(:,6) MatriceParticules(:,1)];xyE(:,1:2)=xyE(:,1:2)/tailleBoite*tailleMatrice;xyE(xyE(:,1)+1>tailleMatrice | xyE(:,2)+1>tailleMatrice | xyE(:,1)-1<-tailleMatrice | xyE(:,2)-1<-tailleMatrice,:)=[];min(xyE(:,1:2))max(xyE(:,1:2))xyE(:,2)=(xyE(:,2)+tailleMatrice)/2;for ii=1:size(xyE,1)MatriceDose(sub2ind([tailleMatrice tailleMatrice],floor(xyE(ii,1))+1,floor(xyE(ii,2))+1))=MatriceDose(sub2ind([tailleMatrice tailleMatrice], floor(xyE(ii,1))+1,floor(xyE(ii,2))+1))+(xyE(ii,3)<Emin).*xyE(ii,3);endimagesc(MatriceDose);colormap;colorbar%caxis([-10000 1300])end